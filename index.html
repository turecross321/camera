<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PRINTER MAN</title>
    <script>
      function connect() {
        const ip = document.getElementById("ipInput").value;
        const controlParent = document.getElementById("controlParent");
        const image = document.getElementById("frame");

        const websocket_url = "ws://" + ip + ":6969";

        try {
          let socket = new WebSocket(websocket_url, "protocolOne");
          controlParent.hidden = true;

          socket.onmessage = function (event) {
            image.src = "data:image/jpeg;base64," + event.data;
          };
        } catch (error) {
          controlParent.hidden = false;
        }
      }
    </script>
  </head>
  <body>
    <div style="display: flex; flex-direction: column">
      <div id="controlParent">
        <label for="ipInput">ip address</label>
        <input id="ipInput" />
        <button onclick="connect()">connect</button>
      </div>
      <img id="frame" />
    </div>
  </body>
</html>
